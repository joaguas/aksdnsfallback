apiVersion: v1
kind: Pod
metadata:
  name: dnsdebugger
  namespace: default
spec:
  nodeName: aks-nodepool1-30873681-vmss000000
  containers:
  - image: mcr.microsoft.com/oss/nginx/nginx:1.13.12-alpine
    imagePullPolicy: Never
    name: debugger
    resources: {}
    volumeMounts:
    - mountPath: /host
      name: host-root
    command: ["/bin/sh", "-c"]
    args:
      chroot /host /bin/bash -c "grep nameserver /etc/resolv.conf || { echo 'no nameserver found, fixing..'; dhclient -r; dhclient; }; grep nameserver /etc/resolv.conf; sleep infinity"
    securityContext:
      privileged: true    
  hostIPC: true
  hostNetwork: true
  hostPID: true
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Never
  volumes:
  - hostPath:
      path: /
      type: ""
    name: host-root
